<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Row Viewer</title>
  <link rel="stylesheet" href="https://unpkg.com/@picocss/pico@latest/css/pico.min.css">
</head>
<body>
  <main class="container">
    <h1>Row Details</h1>
    <div id="row-content">Loading...</div>
    <a href="index.html">‚Üê Back</a>
  </main>

  <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>
  <script>
  const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vS4zi8Hcg6gWlEzMOexYMcRaPtBUbI4VT-VMI-GO_4xXIyWJHJgwfS5cUIkiid-4E_XpvVniMRRtyEi/pub?output=csv";
  
  const urlParams = new URLSearchParams(window.location.search);
  const requestedRow = parseInt(urlParams.get("row"));
  
  fetch(sheetUrl)
    .then(res => res.text())
    .then(csv => {
      const parsed = Papa.parse(csv.trim(), { skipEmptyLines: true });
      const lines = parsed.data;
      const headers = lines[0];
      const dataRow = lines[requestedRow];
  
      const contentDiv = document.getElementById("row-content");
  
      if (isNaN(requestedRow) || requestedRow < 1 || requestedRow >= lines.length) {
        contentDiv.innerHTML = "<p><strong>Error:</strong> Invalid row requested.</p>";
        return;
      }
  
      const data = {};
      headers.forEach((header, i) => {
        data[header.trim()] = dataRow[i] ? dataRow[i].trim() : '';
      });
  
      const html = `
        <article>
          <h2>${data["Property name"] || "Unnamed Property"}</h2>
          <h4>Type: ${data["Property type"] || "Unknown Type"}</h4>
          ${data["Pic"] ? `<img src="${data["Pic"]}" alt="Property Picture" style="max-width:100%;height:auto;">` : ''}
          <p>${data["Note 1"] || ""}</p>
          <h3>Price: ${data["Price"] || "Contact us"}</h3>
        </article>
      `;
  
      contentDiv.innerHTML = html;
    })
    .catch(err => {
      console.error("Fetch failed:", err);
      document.getElementById("row-content").innerHTML = "<p>Error loading spreadsheet.</p>";
    });
  </script>
</body>
</html>